# Generated by Django 5.2.7 on 2025-11-12 06:20

from django.db import migrations


class Migration(migrations.Migration):

    dependencies = [
        ('library', '0010_booktransaction_txn_member_txn_idx_and_more'),
    ]

    operations = [
        migrations.RunSQL(
            """
            -- PostgreSQL partial unique index:
            CREATE UNIQUE INDEX IF NOT EXISTS uq_active_issue_per_book
            ON library_booktransaction (book_id)
            WHERE txn_type = 'ISSUE' AND is_active = TRUE;
            """,
            reverse_sql="""
            DROP INDEX IF EXISTS uq_active_issue_per_book;
            """,
        ),
    ]
